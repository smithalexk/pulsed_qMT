function [Envelope,Timing] = setPulseEnvelope(pwPulse,shape)
%% SETPULSEENVELOPE - Constructs a pulse envelope for a given shape
% Creates envelope and timing vectors for a given pulse width and RF shape
%
% Syntax:  [Envelope,Timing] = setPulseEnvelope(pwPulse,RFShape)
%
% Inputs:
%   pwPulse - Length of the pulse (s)
%   RFShape - Shape of the RF Pulse (Gauss, SincPulse,
%             SincGauss, CW)
%
% Outputs:
%   Envelope - Envelope of pulse (indexed to 1)
%   Timing   -  Timing of pulse (s)
%
%
% Other m-files required: none
% Subfunctions: none
% MAT-files required: none
%
%------------- BEGIN CODE --------------

% Get shape of RF pulse
switch lower(shape)
    case 'sincpulse'
        B1s = [   0;   411;   841;  1274;  1694;  2084;  2427;  2705;  2903;  3005;    
               3001;  2881;  2641;  2277;  1795;  1201;   509;  -266; -1101; -1970;          
              -2845; -3693; -4481; -5174; -5737; -6136; -6341; -6322; -6056; -5525;   
              -4716; -3624; -2251;  -606;  1294;  3424;  5752;  8240; 10845; 13517;                 
              16205; 18855; 21411; 23819; 26027; 27987; 29654; 30993; 31971; 32567;   
              32767; 32567; 31971; 30993; 29654; 27987; 26027; 23819; 21411; 18855;   
              16205; 13517; 10845;  8240;  5752;  3424;  1294;  -606; -2251; -3624;        
              -4716; -5525; -6056; -6322; -6341; -6136; -5737; -5174; -4481; -3693;   
              -2845; -1970; -1101;  -266;   509;  1201;  1795;  2277;  2641;  2881;          
               3001;  3005;  2903;  2705;  2427;  2084;  1694;  1274;   841;   411; 
                  0                                                                ]; 
   case 'sincsgauss'    
         B1s = [0;     413;   859;   1337;  1847;  2389;  2962;  3568;  4204;  4870; 
                5565;  6288;  7038;  7814;  8613;  9435;  10277; 11138; 12015; 12906; 
                13809; 14721; 15640; 16563; 17487; 18409; 19327; 20237; 21136; 22023;
                22892; 23742; 24570; 25372; 26146; 26889; 27598; 28271; 28905; 29497;
                30046; 30549; 31005; 31411; 31767; 32070; 32320; 32515; 32655; 32739;
                32767; 32739; 32655; 32515; 32320; 32070; 31767; 31411; 31005; 30549;
                30046; 29497; 28905; 28271; 27598; 26889; 26146; 25372; 24570; 23742;
                22892; 22023; 21136; 20237; 19327; 18409; 17487; 16563; 15640; 14721;
                13809; 12906; 12015; 11138; 10277; 9435;  8613;  7814;  7038;  6288;
                5565;  4870;  4204;  3568;  2962;  2389;  1847;  1337;  859;   413;
                0                                                                    ];
    case 'gauss'
        B1s = [0.0166; 0.0196; 0.0230; 0.0270; 0.0315; 0.0367; 0.0425; 0.0492;
            0.0567; 0.0651; 0.0745; 0.0850; 0.0966; 0.1094; 0.1235; 0.1389;
            0.1558; 0.1740; 0.1938; 0.2151; 0.2379; 0.2622; 0.2880; 0.3153;
            0.3440; 0.3740; 0.4052; 0.4376; 0.4710; 0.5051; 0.5399; 0.5751;
            0.6105; 0.6459; 0.6810; 0.7156; 0.7493; 0.7820; 0.8133; 0.8430;
            0.8708; 0.8965; 0.9197; 0.9404; 0.9582; 0.9731; 0.9848; 0.9932;
            0.9983; 1.0000; 0.9983; 0.9932; 0.9848; 0.9731; 0.9582; 0.9404;
            0.9197; 0.8965; 0.8708; 0.8430; 0.8133; 0.7820; 0.7493; 0.7156;
            0.6810; 0.6459; 0.6105; 0.5751; 0.5399; 0.5051; 0.4710; 0.4376;
            0.4052; 0.3740; 0.3440; 0.3153; 0.2880; 0.2622; 0.2379; 0.2151;
            0.1938; 0.1740; 0.1558; 0.1389; 0.1235; 0.1094; 0.0966; 0.0850;
            0.0745; 0.0651; 0.0567; 0.0492; 0.0425; 0.0367; 0.0315; 0.0270;
            0.0230; 0.0196; 0.0166; 0.0140];
        
    case 'cw'
        B1s = [1; 1; 1; 1; 1];
    otherwise
        error('No Known Pulse shape for: %s\n',shape);

end

% Calulate pulse based B1amp amd pw
Envelope = (B1s./max(B1s));
Timing = linspace(0,pwPulse,length(B1s))';


end
%------------- END OF CODE --------------